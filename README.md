# üöÄ –°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Email ‚Üí SMS ‚Üí Telegram)

[![Python](https://img.shields.io/badge/Python-3.12-blue)]()
[![Django](https://img.shields.io/badge/Django-5.x-0C4B33)]()
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-16-336791)]()
[![Celery](https://img.shields.io/badge/Celery-5.x-37814A)]()
[![Redis](https://img.shields.io/badge/Redis-7-D82C20)]()
[![Docker Compose](https://img.shields.io/badge/Docker-Compose-2496ED)]()
[![Tests](https://img.shields.io/badge/pytest-passing-brightgreen)]()

–ù–∞–¥—ë–∂–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∫–∞–Ω–∞–ª–∞–º —Å —Ñ–æ–ª–ª–±—ç–∫–æ–º: –µ—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –∫–∞–Ω–∞–ª –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª ‚Äî –ø—Ä–æ–±—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π. –û—Ç–ø—Ä–∞–≤–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —á–µ—Ä–µ–∑ Celery, –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è.

---

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–°—Ç–µ–∫](#-—Å—Ç–µ–∫)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è-env)
- [API](#-api)
- [–ü—Ä–∏–º–µ—Ä—ã cURL –∏ –æ—Ç–≤–µ—Ç—ã](#-–ø—Ä–∏–º–µ—Ä—ã-curl-–∏-–æ—Ç–≤–µ—Ç—ã)
- [–¢–µ—Å—Ç—ã](#-—Ç–µ—Å—Ç—ã)
- [–¢—Ä–∞–±–ª—à—É—Ç–∏–Ω–≥](#-—Ç—Ä–∞–±–ª—à—É—Ç–∏–Ω–≥)
- [–õ–∏—Ü–µ–Ω–∑–∏—è](#-–ª–∏—Ü–µ–Ω–∑–∏—è)

---

## ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- API –¥–ª—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –æ—á–µ—Ä–µ–¥—å.
- –ü–æ—Ä—è–¥–æ–∫ –∫–∞–Ω–∞–ª–æ–≤ –Ω–∞ –∑–∞–ø—Ä–æ—Å: `["email", "sms", "telegram"]`.
- –î–æ **3 –ø–æ–ø—ã—Ç–æ–∫** –Ω–∞ –∫–∞–∂–¥—ã–π –∫–∞–Ω–∞–ª; –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ ‚Äî —Ñ–æ–ª–ª–±—ç–∫ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π.
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫: –∫–∞–Ω–∞–ª, –ø–æ–ø—ã—Ç–∫–∞, —Å—Ç–∞—Ç—É—Å, –æ—à–∏–±–∫–∞, –æ—Ç–≤–µ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, —Ç–∞–π–º—Å—Ç–µ–º–ø—ã.
- –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∫–∞–Ω–∞–ª–æ–≤ ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã (–ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö).

---

## üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
flowchart LR
    A[HTTP POST /api/notify/] --> B[Create Notification (DB)]
    B --> C[Celery Task send_notification_task]
    C --> D{Email OK?}
    D -- –î–∞ --> E[Status: sent]
    D -- –ù–µ—Ç --> F{SMS OK?}
    F -- –î–∞ --> E
    F -- –ù–µ—Ç --> G{Telegram OK?}
    G -- –î–∞ --> E
    G -- –ù–µ—Ç --> H[Status: failed]
    C -.-> I[(NotificationAttempt –∑–∞–ø–∏—Å–∏)]


üõ† –°—Ç–µ–∫

Python 3.12 ¬∑ Django 5 ¬∑ PostgreSQL 16 ¬∑ Celery 5 ¬∑ Redis 7 ¬∑ Docker ¬∑ Docker Compose ¬∑ Gunicorn ¬∑ pytest


‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

    # 1) –°–∫–æ–ø–∏—Ä—É–π –∫–æ–Ω—Ñ–∏–≥ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    cp .env.example .env

    # 2) –ü–æ–¥–Ω–∏–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
    docker compose up --build

    # 3) –°–æ–∑–¥–∞–π –º–∏–≥—Ä–∞—Ü–∏–∏ (–æ–¥–∏–Ω —Ä–∞–∑, –µ—Å–ª–∏ —Ñ–∞–π–ª–æ–≤ –º–∏–≥—Ä–∞—Ü–∏–π –µ—â—ë –Ω–µ—Ç)
    docker compose exec web python manage.py makemigrations notifications

    # 4) –ü—Ä–∏–º–µ–Ω—è–π –º–∏–≥—Ä–∞—Ü–∏–∏
    docker compose exec web python manage.py migrate

    # 5) –°–æ–∑–¥–∞–π —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ –∂–µ–ª–∞–Ω–∏—é –¥–ª—è –∞–¥–º–∏–Ω–∫–∏)
    docker compose exec web python manage.py createsuperuser


–ê–¥–º–∏–Ω–∫–∞: http://localhost:8000/admin/

üì° API
POST /api/notify/ ‚Äî –ø–æ—Å—Ç–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –æ—á–µ—Ä–µ–¥—å

Body (JSON):

    {
    "user_id": 1,
    "subject": "–ü—Ä–∏–≤–µ—Ç!",
    "message": "–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ",
    "channels": ["email", "sms", "telegram"]
    }

    user_id ‚Äî –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å).
    message ‚Äî –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.
    channels ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ["email", "sms", "telegram"].  

Response (200):

    {
    "id": 10,
    "status": "pending",
    "created_at": "2025-09-18T22:45:13.123456+00:00"
    }

üß™ –ü—Ä–∏–º–µ—Ä—ã cURL –∏ –æ—Ç–≤–µ—Ç—ã

    1) –£—Å–ø–µ—à–Ω–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –æ—á–µ—Ä–µ–¥—å

        curl -X POST http://localhost:8000/api/notify/ \
            -H "Content-Type: application/json" \
            -d '{
                    "user_id": 1,
                    "subject": "–ü—Ä–∏–≤–µ—Ç!",
                    "message": "–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ",
                    "channels": ["email", "sms", "telegram"]
                }'
    
        –û—Ç–≤–µ—Ç (200):
            { "id": 12, "status": "pending", "created_at": "2025-09-18T22:45:13.123456+00:00" }

üß´ –¢–µ—Å—Ç—ã

    docker compose exec web pytest -vv